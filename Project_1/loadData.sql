





INSERT INTO USERS(USER_ID, FIRST_NAME, LAST_NAME, YEAR_OF_BIRTH, MONTH_OF_BIRTH, DAY_OF_BIRTH, GENDER)
SELECT USER_ID, FIRST_NAME, LAST_NAME, YEAR_OF_BIRTH, MONTH_OF_BIRTH, DAY_OF_BIRTH, GENDER
FROM PUBLIC_USER_INFORMATION


-- How do we prevent loading (b,a) if we already have (a,b)?
INSERT INTO FRIENDS(USER1_ID, USER2_ID)
SELECT USER1_ID, USER2_ID
FROM PUBLIC_ARE_FRIENDS


CREATE SEQUENCE sequence seq1
	START WITH 1
	INCREMENT BY 1;

CREATE TRIGGER add_city_id
	BEFORE INSERT ON CITIES
		FOR EACH ROW
			BEGIN
				SELECT seq1.NEXTVAL INTO :NEW.CITY_ID FROM DUAL;
			END;
/

INSERT INTO CITIES(CITY_ID, CITY_NAME, STATE_NAME, COUNTRY_NAME)
SELECT * FROM (SELECT CURRENT_CITY, CURRENT_STATE, CURRENT_COUNTRY FROM PUBLIC_USER_INFORMATION 
	UNION 
SELECT HOMETOWN_CITY, HOMETOWN_STATE, HOMETOWN_COUNTRY FROM PUBLIC_USER_INFORMATION)

-- test code
-- SELECT TOP 100 CURRENT_CITY, CURRENT_STATE, CURRENT_COUNTRY FROM PUBLIC_USER_INFORMATION WHERE ROWNUM <= 20;
-- 	UNION 
-- SELECT TOP 100 HOMETOWN_CITY, HOMETOWN_STATE, HOMETOWN_COUNTRY FROM PUBLIC_USER_INFORMATION WHERE ROWNUM <= 20